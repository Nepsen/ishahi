<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="https://assets.onecompiler.app/438cc35sk/43g7ssatu/image-removebg-preview%20(2).png" type="favicon">
    <title>Ishahi</title>
    <meta name="description" content="Comprehensive Islamic application with accurate prayer times, Quranic resources, and live streaming from Makkah and Madinah">
    <meta name="keywords" content="prayer times, Islamic calendar, Quran, Hadith, Ramadan, Muslim">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #2c5fa8;
            --secondary-color: #4CAF50;
            --accent-color: #FF9800;
            --text-color: #333;
            --bg-color: #f9f9f9;
            --card-bg: #fff;
            --shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            --border-radius: 16px;
            --transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.1);
            --prayer-active-gradient: linear-gradient(135deg, #01051c 0%, #061980 100%);
            --prayer-past-color: #e0e0e0;
            --prayer-current-color: #4CAF50;
            --prayer-next-color: #2c5fa8;
            --text-1color: rgba(0, 0, 0, 0.05);
        }

        [data-theme="dark"] {
            --primary-color: #4CAF50;
            --secondary-color: #2c5fa8;
            --accent-color: #FFC107;
            --text-color: #f0f0f0;
            --bg-color: #121212;
            --card-bg: #1e1e1e;
            --shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            --prayer-active-gradient: linear-gradient(135deg, #01051c 0%, #061980 100%);
            --prayer-past-color: #333;
            --prayer-current-color: #4CAF50;
            --prayer-next-color: #2c5fa8;
            --text-1color: #d4cdcd;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', 'Segoe UI', sans-serif;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            transition: var(--transition);
            line-height: 1.7;
            overflow-x: hidden;
            min-height: 100vh;
        }

        /* Splash Screen */
        .splash-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--prayer-active-gradient);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            transition: opacity 0.8s ease, visibility 0.8s ease;
        }

        .splash-screen.hidden {
            opacity: 0;
            visibility: hidden;
        }

        .splash-logo {
            font-size: 3rem;
            color: white;
            margin-bottom: 2rem;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .splash-logo i {
            font-size: 4rem;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .splash-title {
            color: white;
            font-size: 2.5rem;
            margin-bottom: 1rem;
            text-align: center;
        }

        .splash-subtitle {
            color: rgba(255, 255, 255, 0.9);
            font-size: 1.2rem;
            margin-bottom: 3rem;
            text-align: center;
            max-width: 600px;
            padding: 0 20px;
        }

        .enter-btn {
            background-color: white;
            color: var(--primary-color);
            border: none;
            padding: 15px 40px;
            font-size: 1.2rem;
            border-radius: 50px;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 600;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }

        .enter-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
        }

        /* Main App */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.8s ease, transform 0.8s ease;
        }

        .container.show {
            opacity: 1;
            transform: translateY(0);
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            margin-bottom: 30px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }

        .logo {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo i {
            font-size: 2.5rem;
        }

        .header-controls {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .theme-switch {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: var(--primary-color);
        }

        input:checked + .slider:before {
            transform: translateX(26px);
        }

        .language-selector {
            position: relative;
        }

        .language-btn {
            background-color: var(--card-bg);
            border: 1px solid rgba(0, 0, 0, 0.1);
            padding: 8px 15px;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: var(--transition);
        }

        .language-btn:hover {
            background-color: rgba(0, 0, 0, 0.05);
        }

        .language-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            background-color: var(--card-bg);
            border-radius: 8px;
            box-shadow: var(--shadow);
            padding: 10px;
            width: 200px;
            z-index: 100;
            display: none;
        }

        .language-dropdown.show {
            display: block;
        }

        .language-option {
            padding: 8px 10px;
            border-radius: 4px;
            cursor: pointer;
            transition: var(--transition);
        }

        .language-option:hover {
            background-color: rgba(0, 0, 0, 0.05);
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 30px;
        }

        /* Prayer Times Section */
        .prayer-times-container {
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--shadow);
            position: sticky;
            top: 20px;
        }

        .prayer-times-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .location-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .location-icon {
            color: var(--primary-color);
            font-size: 1.5rem;
        }

        .location-text {
            font-weight: 500;
        }

        .current-date {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .countdown-circle {
            width: 200px;
            height: 200px;
            margin: 25px auto;
            position: relative;
        }

        .circle-svg {
            width: 100%;
            height: 100%;
            transform: rotate(-90deg);
        }

        .circle-bg {
            fill: none;
            stroke: rgba(0, 0, 0, 0.1);
            stroke-width: 10;
        }

        .circle-progress {
            fill: none;
            stroke: var(--primary-color);
            stroke-width: 10;
            stroke-linecap: round;
            stroke-dasharray: 628;
            stroke-dashoffset: 628;
            transition: stroke-dashoffset 1s ease-out;
        }

        .circle-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            width: 100%;
        }

        .circle-time {
            font-size: 2.2rem;
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 5px;
        }

        .circle-label {
            font-size: 1.2rem;
            color: var(--text-color);
            opacity: 0.9;
        }

        .circle-subtext {
            font-size: 0.9rem;
            opacity: 0.7;
        }

        .prayer-times-list {
            display: grid;
            gap: 15px;
        }

        .prayer-time-card {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 18px;
            border-radius: 12px;
            background-color: var(--prayer-past-color);
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        .prayer-time-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 5px;
            height: 100%;
            background-color: var(--primary-color);
            transition: var(--transition);
            opacity: 0;
        }

        .prayer-time-card.current {
            background-color: var(--prayer-current-color);
            color: white;
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(76, 175, 80, 0.3);
        }

        .prayer-time-card.next {
            background-color: var(--prayer-next-color);
            color: white;
        }

        .prayer-time-card.current::before,
        .prayer-time-card.next::before {
            opacity: 1;
        }

        .prayer-time-card.current .prayer-name,
        .prayer-time-card.current .prayer-time,
        .prayer-time-card.current .time-remaining,
        .prayer-time-card.next .prayer-name,
        .prayer-time-card.next .prayer-time,
        .prayer-time-card.next .time-remaining {
            color: white;
        }

        .prayer-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .prayer-icon {
            font-size: 1.5rem;
            color: var(--primary-color);
        }

        .prayer-time-card.current .prayer-icon,
        .prayer-time-card.next .prayer-icon {
            color: white;
        }

        .prayer-details {
            display: flex;
            flex-direction: column;
        }

        .prayer-name {
            font-weight: bold;
            font-size: 1.1rem;
            color: var(--text-color);
        }

        .prayer-time {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--text-color);
        }

        .time-remaining {
            font-size: 0.9rem;
            color: var(--text-color);
            opacity: 0.8;
        }

        /* Content Section */
        .content-section {
            display: grid;
            gap: 30px;
        }

        .card {
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--shadow);
            transition: var(--transition);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .card-title {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary-color);
        }

        .card-actions {
            display: flex;
            gap: 10px;
        }

        .card-btn {
            background-color: var(--text-1color);
            border: none;
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.9rem;
        }

        .card-btn:hover {
            background-color: rgba(0, 0, 0, 0.1);
        }

        /* Ramadan Section */
        .ramadan-times {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .ramadan-card {
            text-align: center;
            padding: 25px;
            border-radius: 12px;
            background-color: rgba(76, 175, 80, 0.1);
            transition: var(--transition);
        }

        .ramadan-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(76, 175, 80, 0.2);
        }

        .ramadan-icon {
            font-size: 2rem;
            color: var(--secondary-color);
            margin-bottom: 15px;
        }

        .ramadan-title {
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 10px;
            color: var(--secondary-color);
        }

        .ramadan-time {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 10px;
            color: var(--text-color);
        }

        .ramadan-day {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        /* Calendar Section */
        .calendar {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 10px;
        }

        .calendar-header-day {
            text-align: center;
            font-weight: bold;
            padding: 12px;
            color: var(--primary-color);
            font-size: 0.9rem;
        }

        .calendar-day {
            text-align: center;
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition);
            position: relative;
            aspect-ratio: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .calendar-day:hover {
            background-color: rgba(44, 95, 168, 0.1);
        }

        .calendar-day.highlight {
            background-color: var(--primary-color);
            color: white;
        }

        .calendar-day.today {
            border: 2px solid var(--primary-color);
        }

        .calendar-day-number {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .calendar-day-event {
            font-size: 0.7rem;
            opacity: 0.8;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 100%;
        }

        /* Streaming Section */
        .stream-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .stream-card {
            position: relative;
            padding-bottom: 56.25%; /* 16:9 aspect ratio */
            height: 0;
            overflow: hidden;
            border-radius: 12px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
            transition: var(--transition);
        }

        .stream-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
        }

        .stream-card iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
        }

        .stream-label {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            padding: 15px;
            background: linear-gradient(to top, rgba(0,0,0,0.7), transparent);
            color: white;
            text-align: center;
            font-size: 1.1rem;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
        }
        
        .article-card {
            background-color: var(--card-bg);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: var(--transition);
        }

        .article-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
        }

        .article-image {
            height: 180px;
            overflow: hidden;
            position: relative;
        }

        .article-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: var(--transition);
        }

        .article-card:hover .article-image img {
            transform: scale(1.1);
        }

        .article-category {
            position: absolute;
            top: 10px;
            left: 10px;
            background-color: var(--primary-color);
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.8rem;
        }

        .article-content {
            padding: 20px;
        }

        .article-title {
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 10px;
            color: var(--text-color);
        }

        .article-excerpt {
            font-size: 0.9rem;
            color: var(--text-color);
            opacity: 0.8;
            margin-bottom: 15px;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .article-meta {
            display: flex;
            justify-content: space-between;
            font-size: 0.8rem;
            opacity: 0.7;
            margin-bottom: 15px;
        }

        .read-more {
            display: inline-block;
            padding: 8px 20px;
            background-color: var(--primary-color);
            color: white;
            border-radius: 8px;
            text-decoration: none;
            font-size: 0.9rem;
            transition: var(--transition);
            font-weight: 500;
        }

        .read-more:hover {
            background-color: var(--secondary-color);
        }

        /* Footer */
        footer {
            margin-top: 50px;
            padding: 40px 0;
            border-top: 1px solid rgba(0, 0, 0, 0.1);
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            margin-bottom: 30px;
        }

        .footer-column h3 {
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 20px;
            color: var(--primary-color);
        }

        .footer-links {
            list-style: none;
        }

        .footer-links li {
            margin-bottom: 10px;
        }

        .footer-links a {
            color: var(--text-color);
            text-decoration: none;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
            opacity: 0.8;
        }

        .footer-links a:hover {
            opacity: 1;
            color: var(--primary-color);
        }

        .footer-links a i {
            font-size: 0.8rem;
        }

        .social-links {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }

        .social-links a {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            background-color: rgba(0, 0, 0, 0.05);
            border-radius: 50%;
            color: var(--text-color);
            transition: var(--transition);
        }

        .social-links a:hover {
            background-color: var(--primary-color);
            color: white;
            transform: translateY(-5px);
        }

        .footer-bottom {
            text-align: center;
            padding-top: 30px;
            border-top: 1px solid rgba(0, 0, 0, 0.1);
            color: var(--text-color);
            opacity: 0.7;
            font-size: 0.9rem;
        }

        /* Notification */
        .notification {
            position: fixed;
            background-color: var(--primary-color);
            color: white;
            padding: 15px 25px;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(44, 95, 168, 0.3);
            display: flex;
            align-items: center;
            gap: 15px;
            z-index: 1000;
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            max-width: 90%;
        }

        .notification.show {
            transform: translateY(0);
            opacity: 1;
        }

        .notification i {
            font-size: 1.5rem;
        }

        .notification-content {
            display: flex;
            flex-direction: column;
        }

        .notification-title {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .notification-message {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .notification-close {
            margin-left: 15px;
            cursor: pointer;
            opacity: 0.7;
            transition: var(--transition);
        }

        .notification-close:hover {
            opacity: 1;
        }

        /* Loading Spinner */
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100px;
            flex-direction: column;
            gap: 10px;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(0, 0, 0, 0.1);
            border-radius: 50%;
            border-top-color: var(--primary-color);
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Responsive Adjustments */
        @media (max-width: 1068px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .prayer-times-container {
                position: relative;
                top: 0;
                margin-bottom: 30px;
            }
            
            .prayer-times-list {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .stream-container {
                grid-template-columns: 1fr;
            }
            
            .ramadan-times {
                grid-template-columns: 1fr;
            }
        }
        /* Mobile First Approach - Responsive Adjustments */
        @media (max-width: 768px) {
            body {
                font-size: 14px;
            }
        
            .container {
                padding: 15px;
            }
        
            header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
                padding: 15px 0;
            }
        
            .header-controls {
                width: 100%;
                justify-content: center;
                flex-wrap: wrap;
            }
        
            .logo {
                font-size: 1.8rem;
                justify-content: center;
            }
        
            .main-content {
                grid-template-columns: 1fr;
            }
        
            .prayer-times-container {
                position: relative;
                top: 0;
                margin-bottom: 20px;
            }
        
            .countdown-circle {
                width: 150px;
                height: 150px;
            }
        
            .circle-time {
                font-size: 1.8rem;
            }
        
            .circle-label {
                font-size: 1rem;
            }
        
            .prayer-times-list {
                grid-template-columns: 1fr;
            }
        
            .prayer-time-card {
                padding: 12px;
            }
        
            .prayer-info {
                gap: 10px;
            }
        
            .prayer-icon {
                font-size: 1.2rem;
            }
        
            /* Content Cards */
            .card {
                padding: 15px;
            }
        
            .card-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
        
            .card-title {
                font-size: 1.3rem;
            }
        
            .card-actions {
                width: 100%;
                justify-content: space-between;
            }
        
            /* Ramadan Section */
            .ramadan-times {
                grid-template-columns: 1fr;
            }
        
            /* Calendar */
            .calendar {
                gap: 5px;
            }
        
            .calendar-day {
                padding: 8px;
                font-size: 0.8rem;
            }
        
            /* Streaming */
            .stream-container {
                grid-template-columns: 1fr;
            }
        
            /* Articles */
            .article-grid {
                grid-template-columns: 1fr;
            }
        
            .article-image {
                height: 150px;
            }
        
            /* Footer */
            .footer-content {
                grid-template-columns: 1fr;
                gap: 20px;
            }
        
            /* AI Assistant */
            .ai-conversation {
                height: 200px;
            }
        
            .ai-message {
                max-width: 90%;
                font-size: 0.9rem;
            }
        }
        
        @media (max-width: 480px) {
            .splash-title {
                font-size: 2rem;
            }
        
            .splash-subtitle {
                font-size: 1rem;
                margin-bottom: 2rem;
            }
        
            .enter-btn {
                padding: 12px 30px;
                font-size: 1rem;
            }
        
            .prayer-time-card {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }
        
            .time-remaining {
                align-self: flex-end;
            }
        
            .ramadan-time {
                font-size: 1.5rem;
            }
        
            .calendar-header-day {
                padding: 8px 5px;
                font-size: 0.7rem;
            }
        
            .calendar-day {
                padding: 5px;
            }
        
            .notification {
                left: 10px;
                right: 10px;
                bottom: 10px;
                max-width: calc(100% - 20px);
            }
        }
        
        /* Small Mobile Devices */
        @media (max-width: 360px) {
            .prayer-name {
                font-size: 0.9rem;
            }
        
            .prayer-time {
                font-size: 0.9rem;
            }
        
            .card-btn {
                padding: 6px 8px;
                font-size: 0.8rem;
            }
        
            .ramadan-card {
                padding: 15px;
            }
        }

        /* AI Assistant Section */
        .ai-assistant {
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--shadow);
            margin-top: 30px;
        }

        .ai-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .ai-icon {
            font-size: 2rem;
            color: var(--primary-color);
        }

        .ai-title {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary-color);
        }

        .ai-subtitle {
            font-size: 1rem;
            opacity: 0.8;
            margin-bottom: 20px;
        }

        .ai-conversation {
            height: 300px;
            overflow-y: auto;
            margin-bottom: 20px;
            padding: 15px;
            background-color: rgba(0, 0, 0, 0.03);
            border-radius: 8px;
        }

        .ai-message {
            margin-bottom: 15px;
            padding: 10px 15px;
            border-radius: 8px;
            max-width: 80%;
        }

        .ai-message.user {
            background-color: rgba(44, 95, 168, 0.1);
            margin-left: auto;
            border-bottom-right-radius: 0;
        }

        .ai-message.assistant {
            background-color: rgba(76, 175, 80, 0.1);
            margin-right: auto;
            border-bottom-left-radius: 0;
        }

        .ai-input-container {
            display: flex;
            gap: 10px;
        }

        .ai-input {
            flex: 1;
            padding: 12px 15px;
            border-radius: 8px;
            border: 1px solid rgba(0, 0, 0, 0.1);
            background-color: var(--card-bg);
            color: var(--text-color);
            font-size: 1rem;
        }

        .ai-send-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 0 20px;
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .ai-send-btn:hover {
            background-color: var(--secondary-color);
        }
    .splash-screen {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(135deg, #01051c 0%, #061980 100%);
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        z-index: 1000;
        color: white;
        text-align: center;
        padding: 20px;
    }

    .splash-content {
        max-width: 600px;
        display: flex;
        flex-direction: column;
        align-items: center;
    }

    .splash-logo {
        font-size: 2.5rem;
        margin-bottom: 2rem;
        display: flex;
        align-items: center;
        gap: 15px;
    }

    .splash-logo i {
        font-size: 3rem;
        animation: pulse 2s infinite;
    }

    .splash-title {
        font-size: 2.5rem;
        margin-bottom: 1rem;
    }

    .splash-subtitle {
        font-size: 1.2rem;
        opacity: 0.9;
        margin-bottom: 3rem;
    }

    /* Loading line styles */
    .loading-line-container {
        width: 300px;
        height: 4px;
        background-color: rgba(255, 255, 255, 0.2);
        border-radius: 2px;
        overflow: hidden;
        margin-bottom: 30px;
    }

    .loading-line {
        height: 100%;
        width: 0%;
        background-color: white;
        border-radius: 2px;
        transition: width 3s linear;
    }

    /* Enter button styles */
    .enter-btn {
        background-color: white;
        color: #2c5fa8;
        border: none;
        padding: 15px 40px;
        font-size: 1.2rem;
        border-radius: 50px;
        cursor: pointer;
        transition: all 0.4s ease;
        font-weight: 600;
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        opacity: 0;
        transform: translateY(20px);
    }

    .enter-btn.visible {
        opacity: 1;
        transform: translateY(0);
    }

    .enter-btn:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
    }

    .hidden {
        display: none;
    }

    @keyframes pulse {
        0% { transform: scale(1); }
        50% { transform: scale(1.1); }
        100% { transform: scale(1); }
    }
    </style>
</head>
<body>
    <!-- Splash Screen -->
    <div class="splash-screen">
        <div class="splash-content">
            <div class="splash-logo">
                <i class="fas fa-mosque"></i>
                <span>Ishahi</span>
            </div>
            <p class="splash-subtitle">Loading prayer times and resources...</p>
            
            <!-- Loading line animation -->
            <div class="loading-line-container">
                <div class="loading-line"></div>
            </div>
        </div>
    </div>

    <!-- Main App Container -->
    <div class="container" id="appContainer">
        <header>
            <div class="logo">
                <i class="fas fa-mosque"></i>
                <span>Ishahi</span>
            </div>
            <div class="header-controls">
                <div class="theme-switch">
                    <i class="fas fa-sun"></i>
                    <label class="switch">
                        <input type="checkbox" id="themeToggle">
                        <span class="slider"></span>
                    </label>
                    <i class="fas fa-moon"></i>
                </div>
            </div>
        </header>
        
        <!-- Notification -->
        <div class="notification" id="notification">
            <i class="fas fa-mosque"></i>
            <div class="notification-content">
                <div class="notification-title" id="notificationTitle">Prayer Time</div>
                <div class="notification-message" id="notificationMessage">Fajr prayer time has started</div>
            </div>
            <div class="notification-close" id="notificationClose">
                <i class="fas fa-times"></i>
            </div>
        </div>
        
        <div class="main-content">
            <!-- Prayer Times Section -->
            <div class="prayer-times-container">
                <div class="prayer-times-header">
                    <div class="location-info">
                        <i class="fas fa-location-dot location-icon"></i>
                        <div>
                            <div class="location-text" id="locationText">Detecting location...</div>
                            <div class="current-date" id="currentDate">- - -</div>
                        </div>
                    </div>
                </div>

                <!-- Countdown Circle -->
                <div class="countdown-circle">
                    <svg class="circle-svg" viewBox="0 0 160 160">
                        <circle class="circle-bg" cx="80" cy="80" r="70"></circle>
                        <circle class="circle-progress" cx="80" cy="80" r="70"></circle>
                    </svg>
                    <div class="circle-text">
                        <div class="circle-time" id="circleTime">00:00</div>
                        <div class="circle-label" id="circleLabel">Loading...</div>
                        <div class="circle-subtext" id="circleSubtext">until next prayer</div>
                    </div>
                </div>

                <!-- Prayer Times List -->
                <div class="prayer-times-list">
                    <div class="prayer-time-card" data-prayer="fajr">
                        <div class="prayer-info">
                            <i class="fas fa-sun prayer-icon"></i>
                            <div class="prayer-details">
                                <div class="prayer-name">Fajr</div>
                                <div class="prayer-time">-:-</div>
                            </div>
                        </div>
                        <div class="time-remaining"></div>
                    </div>
                    <div class="prayer-time-card" data-prayer="dhuhr">
                        <div class="prayer-info">
                            <i class="fas fa-sun prayer-icon"></i>
                            <div class="prayer-details">
                                <div class="prayer-name">Dhuhr</div>
                                <div class="prayer-time">-:-</div>
                            </div>
                        </div>
                        <div class="time-remaining"></div>
                    </div>
                    <div class="prayer-time-card" data-prayer="asr">
                        <div class="prayer-info">
                            <i class="fas fa-sun prayer-icon"></i>
                            <div class="prayer-details">
                                <div class="prayer-name">Asr</div>
                                <div class="prayer-time">-:-</div>
                            </div>
                        </div>
                        <div class="time-remaining"></div>
                    </div>
                    <div class="prayer-time-card" data-prayer="maghrib">
                        <div class="prayer-info">
                            <i class="fas fa-moon prayer-icon"></i>
                            <div class="prayer-details">
                                <div class="prayer-name">Maghrib</div>
                                <div class="prayer-time">-:-</div>
                            </div>
                        </div>
                        <div class="time-remaining"></div>
                    </div>
                    <div class="prayer-time-card" data-prayer="isha">
                        <div class="prayer-info">
                            <i class="fas fa-moon prayer-icon"></i>
                            <div class="prayer-details">
                                <div class="prayer-name">Isha</div>
                                <div class="prayer-time">-:-</div>
                            </div>
                        </div>
                        <div class="time-remaining"></div>
                    </div>
                </div>
            </div>

            <!-- Main Content Section -->
            <div class="content-section">
                <!-- Today's Date Card -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Today's Islamic Date</div>
                    </div>
                    <div class="hijri-date" id="hijriDate">Loading Islamic date...</div>
                </div>

                <!-- Ramadan Times Card -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Ramadan Timings</div>
                        <div class="card-actions">
                            <button class="card-btn">
                                <i class="fas fa-calendar"></i>
                                <span>Calendar</span>
                            </button>
                        </div>
                    </div>
                    <div class="ramadan-times">
                        <div class="ramadan-card">
                            <i class="fas fa-moon ramadan-icon"></i>
                            <div class="ramadan-title">Sehri Ends</div>
                            <div class="ramadan-time" id="sehriTime">-:-</div>
                            <div class="ramadan-day" id="ramadanDay">-</div>
                        </div>
                        <div class="ramadan-card">
                            <i class="fas fa-sun ramadan-icon"></i>
                            <div class="ramadan-title">Iftar Time</div>
                            <div class="ramadan-time" id="iftarTime">-:-</div>
                            <div class="ramadan-day">Ramadan Mubarak</div>
                        </div>
                    </div>
                </div>

                <!-- Islamic Calendar Card -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Islamic Calendar</div>
                        <div class="card-actions">
                            <button class="card-btn" id="prevMonthBtn">
                                <i class="fas fa-chevron-left"></i>
                            </button>
                            <button class="card-btn" id="nextMonthBtn">
                                <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                    </div>
                    <div class="calendar" id="calendar">
                        <div class="calendar-header-day">Sun</div>
                        <div class="calendar-header-day">Mon</div>
                        <div class="calendar-header-day">Tue</div>
                        <div class="calendar-header-day">Wed</div>
                        <div class="calendar-header-day">Thu</div>
                        <div class="calendar-header-day">Fri</div>
                        <div class="calendar-header-day">Sat</div>
                        <!-- Calendar days will be populated by JavaScript -->
                    </div>
                </div>


                <!-- Live Streaming Card with YouTube API -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Live Streaming</div>
                        <div class="card-actions">
                            <button class="card-btn" id="refreshStreams">
                                <i class="fas fa-sync-alt"></i>
                                <span>Refresh</span>
                            </button>
                        </div>
                    </div>
                    <div class="stream-container" id="streamContainer">
                        <div class="loading">
                            <div class="spinner"></div>
                            <div>Loading live streams...</div>
                        </div>
                    </div>
                </div>

                <!-- AI Islamic Assistant Card -->
                <div class="ai-assistant" id="aiAssistant">
                    <div class="ai-header">
                        <i class="fas fa-robot ai-icon"></i>
                        <div class="ai-title">AI Islamic Assistant</div>
                    </div>
                    <div class="ai-subtitle">Ask any question about Islam</div>
                    <div class="ai-conversation" id="aiConversation">
                    </div>
                    <div class="ai-input-container">
                        <input type="text" class="ai-input" id="aiInput" placeholder="Ask your question...">
                        <button class="ai-send-btn" id="aiSendBtn">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>

                <!-- Islamic Articles Card -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Islamic Articles</div>
                        <div class="card-actions">
                            <button class="card-btn" id="view-all-articles">
                                <i class="fas fa-book-open"></i>
                                <span>View All</span>
                            </button>
                        </div>
                    </div>
                    <div class="articles-container">
                        <div class="article-card">
                            <div class="article-image">
                                <img src="https://quranayat.com/wp-content/uploads/2020/06/The-Salah-The-Second-Pillar-of-Islam-Quran-Ayat.jpg" alt="The Importance of Salah in Islam">
                                <span class="article-category">Prayer</span>
                            </div>
                            <div class="article-content">
                                <h3 class="article-title">The Importance of Salah in Islam</h3>
                                <p class="article-excerpt">Salah is the second pillar of Islam and is obligatory for all Muslims. It establishes a direct connection between the worshipper and Allah.</p>
                                <div class="article-meta">
                                    <span>Islamic Scholar</span>
                                    <span>May 15, 2023</span>
                                </div>
                                <a href="https://quranayat.com/the-salah-the-second-pillar-of-islam/" class="read-more">Read More</a>
                            </div>
                        </div>
                        
                        <div class="article-card">
                            <div class="article-image">
                                <img src="https://riwaqalquran.com/wp-content/uploads/2024/02/how-to-learn-arabic-language-to-understand-quran-1024x417.jpg" alt="Understanding the Quran">
                                <span class="article-category">Quran</span>
                            </div>
                            <div class="article-content">
                                <h3 class="article-title">Understanding the Quran</h3>
                                <p class="article-excerpt">The Quran is the holy book of Islam revealed to Prophet Muhammad (PBUH) over 23 years. It's guidance for all mankind.</p>
                                <div class="article-meta">
                                    <span>Quran Teacher</span>
                                    <span>May 10, 2023</span>
                                </div>
                                <a href="https://riwaqalquran.com/blog/how-to-learn-arabic-language-to-understand-quran/" class="read-more">Read More</a>
                            </div>
                        </div>
                        
                        <div class="article-card">
                            <div class="article-image">
                                <img src="https://fajrmagazine.com/wp-content/uploads/ahadeeth-on-the-Virtues-of-Ramadan.jpg" alt="The Virtues of Ramadan">
                                <span class="article-category">Ramadan</span>
                            </div>
                            <div class="article-content">
                                <h3 class="article-title">The Virtues of Ramadan</h3>
                                <p class="article-excerpt">Ramadan is the month of fasting, prayer, reflection and community. Learn about its spiritual benefits and rewards.</p>
                                <div class="article-meta">
                                    <span>Ramadan Guide</span>
                                    <span>Apr 1, 2023</span>
                                </div>
                                <a href="https://fajrmagazine.com/ahaadeeth-on-the-virtues-of-ramadan/" class="read-more">Read More</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <footer>
            <div class="footer-content">
                <div class="footer-column">
                    <h3>Ishahi</h3>
                    <p>Your comprehensive digital platform for accurate prayer times, Quranic guidance, and authentic Islamic knowledge.</p>
                    <div class="social-links">
                        <a href="https://www.facebook.com/share/g/16RQJphgv5/"><i class="fab fa-facebook-f"></i></a>
                        <a href="#"><i class="fab fa-twitter"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                        <a href="#"><i class="fab fa-youtube"></i></a>
                    </div>
                </div>
                <div class="footer-column">
                    <h3>Quick Links</h3>
                    <ul class="footer-links">
                        <li><a href="#"><i class="fas fa-chevron-right"></i> Prayer Times</a></li>
                        <li><a href="#"><i class="fas fa-chevron-right"></i> Quran Recitation</a></li>
                        <li><a href="#"><i class="fas fa-chevron-right"></i> Hadith Collection</a></li>
                        <li><a href="#"><i class="fas fa-chevron-right"></i> Islamic Calendar</a></li>
                        <li><a href="#"><i class="fas fa-chevron-right"></i> Ramadan Planner</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>Resources</h3>
                    <ul class="footer-links">
                        <li><a href="https://www.islamicity.org/?gad_source=1&gad_campaignid=21864837748&gbraid=0AAAAAC0wPGe2z1H-DgraPQZONWLAEtxJX&gclid=Cj0KCQjwlMfABhCWARIsADGXdy_WwMmLmGoYgtMU8YVT6bbDRmcsr6pSJt4LfOc1xr_jvWlMxn7mnIMaAqCFEALw_wcB"><i class="fas fa-chevron-right"></i> Islamic Articles</a></li>
                        <li><a href="https://www.amjaonline.org/fatwa/en/"><i class="fas fa-chevron-right"></i> Fatwa Database</a></li>
                        <li><a href="https://gtaf.org/blog/most-important-duas-and-adhkar-for-daily-life/?gad_source=1&gad_campaignid=21321865657&gbraid=0AAAAAC_6MEVHFRHR-q5x7xyWiqQjogx3Q&gclid=Cj0KCQjwlMfABhCWARIsADGXdy_Df16Z0BQZyvXXLtaIbeYpAiO66nkwlK9mHZDgdusqvcitJy8od0QaAkpHEALw_wcB"><i class="fas fa-chevron-right"></i> Dua Collection</a></li>
                        <li><a href="https://greendome.org/?gad_source=1&gad_campaignid=11604801799&gbraid=0AAAAABzETUpZAME2_exmOG-nUnp5pKyUE&gclid=Cj0KCQjwlMfABhCWARIsADGXdy_gH7ii_Uq2s4L-8A0q5uRsTLRrkFXTNBR1CwjTjlwsXMLwJcebj78aAnqWEALw_wcB"><i class="fas fa-chevron-right"></i> Islamic Videos</a></li>
                        <li><a href="https://www.halaltrip.com/find-mosques-near-me/"><i class="fas fa-chevron-right"></i> Mosque Finder</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>Developed with <i class="fas fa-heart" style="color: #e74c3c;"></i> for the Muslim Ummah</p>
            </div>
        </footer>
    </div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // YouTube API Key (Note: In production, this should be secured server-side)
    const YOUTUBE_API_KEY = 'AIzaSyAqXHbNakvVR_SCW3_HgEaycrO2oL89URA';
    const WIKIPEDIA_API_URL = 'https://en.wikipedia.org/w/api.php?origin=*&action=query&format=json&prop=extracts|pageimages&exintro=true&explaintext=true&pithumbsize=300&titles=';
    
    // Default coordinates for Makkah
    const DEFAULT_COORDS = {
        latitude: 21.3891,
        longitude: 39.8579
    };

    // Current prayer times data
    let currentPrayerTimes = null;
    let currentLocation = null;
    let currentPrayerState = {
        current: null,
        next: null
    };

    // Loading elements
    const loadingLine = document.querySelector('.loading-line');
    const splashScreen = document.querySelector('.splash-screen');
    const appContainer = document.getElementById('appContainer');

    // Start loading animation
    loadingLine.style.width = '100%';
    
    // Initialize everything after 3 seconds (simulating loading)
    setTimeout(() => {
        // Hide splash screen
        splashScreen.style.opacity = '0';
        splashScreen.style.visibility = 'hidden';
        
        // Show main app
        appContainer.classList.add('show');
        
        // Initialize the app
        initializeApp();
    }, 3000);

    // Theme Toggle Functionality
    const themeToggle = document.getElementById('themeToggle');
    
    // Check for saved theme preference or use preferred color scheme
    const savedTheme = localStorage.getItem('theme') || 
                      (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
    
    // Apply the saved theme
    if (savedTheme === 'dark') {
        document.documentElement.setAttribute('data-theme', 'dark');
        themeToggle.checked = true;
    }
    
    // Theme toggle event listener
    themeToggle.addEventListener('change', function() {
        if (this.checked) {
            document.documentElement.setAttribute('data-theme', 'dark');
            localStorage.setItem('theme', 'dark');
        } else {
            document.documentElement.removeAttribute('data-theme');
            localStorage.setItem('theme', 'light');
        }
    });

    // YouTube Live Streams with fallback
    async function fetchLiveStreams() {
        const streamContainer = document.getElementById('streamContainer');
        streamContainer.innerHTML = '<div class="loading"><div class="spinner"></div><div>Loading live streams...</div></div>';
    
        try {
            // List of reliable Kaaba/Makkah and Madinah live stream IDs
            const kaabaStreams = [
                'yN27UfPu72U', // Kaaba live stream 1
                '2Gub8-cSH9c', // Kaaba live stream 2
                'bNY8a2BB5Gc'  // Backup Kaaba stream
            ];
    
            const madinahStreams = [
                'yWw0DWJQVtU', // Madinah live stream 1
                '7i0dC0z4v6I', // Madinah live stream 2
                'rHWSRMcGGBQ'  // Backup Madinah stream
            ];
    
            // Function to check if a stream is available
            async function checkStreamAvailability(streamId) {
                try {
                    const response = await fetch(`https://www.youtube.com/oembed?url=https://www.youtube.com/watch?v=${streamId}&format=json`);
                    return response.ok;
                } catch (error) {
                    return false;
                }
            }
    
            // Find first available Kaaba stream
            let kaabaStreamId = null;
            for (const streamId of kaabaStreams) {
                if (await checkStreamAvailability(streamId)) {
                    kaabaStreamId = streamId;
                    break;
                }
            }
    
            // Find first available Madinah stream
            let madinahStreamId = null;
            for (const streamId of madinahStreams) {
                if (await checkStreamAvailability(streamId)) {
                    madinahStreamId = streamId;
                    break;
                }
            }
    
            // Final fallback if everything else fails
            if (!kaabaStreamId) kaabaStreamId = kaabaStreams[0];
            if (!madinahStreamId) madinahStreamId = madinahStreams[0];
    
            // Build the streams HTML
            const streamsHTML = `
                <div class="stream-card">
                    <iframe src="https://www.youtube.com/embed/${kaabaStreamId}" frameborder="0"
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                        allowfullscreen
                        title="Kaaba Live Stream">
                    </iframe>
                    <div class="stream-label">
                        <i class="fas fa-kaaba"></i>
                        <span>Kaaba Live</span>
                    </div>
                </div>
                <div class="stream-card">
                    <iframe src="https://www.youtube.com/embed/${madinahStreamId}" frameborder="0"
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                        allowfullscreen
                        title="Madinah Live Stream">
                    </iframe>
                    <div class="stream-label">
                        <i class="fas fa-mosque"></i>
                        <span>Madinah Live</span>
                    </div>
                </div>
            `;
    
            streamContainer.innerHTML = streamsHTML;
    
            // Double-check iframe availability after loading
            setTimeout(() => {
                const iframes = document.querySelectorAll('.stream-card iframe');
                iframes.forEach(iframe => {
                    iframe.onerror = function() {
                        // If iframe fails to load, refresh streams
                        fetchLiveStreams();
                    };
                });
            }, 5000);
    
        } catch (error) {
            console.error('Error fetching live streams:', error);
            streamContainer.innerHTML = getFallbackStreams();
        }
    }
    
    // Fallback streams with multiple options
    function getFallbackStreams() {
        const kaabaFallbacks = [
            'yN27UfPu72U', // Kaaba live stream 1
            '2Gub8-cSH9c', // Kaaba live stream 2
            'bNY8a2BB5Gc'  // Backup Kaaba stream
        ];
    
        const madinahFallbacks = [
            'yWw0DWJQVtU', // Madinah live stream 1
            '7i0dC0z4v6I', // Madinah live stream 2
            'rHWSRMcGGBQ'  // Backup Madinah stream
        ];
    
        // Randomly select fallback streams to distribute load
        const randomKaaba = kaabaFallbacks[Math.floor(Math.random() * kaabaFallbacks.length)];
        const randomMadinah = madinahFallbacks[Math.floor(Math.random() * madinahFallbacks.length)];
    
        return `
            <div class="stream-card">
                <iframe src="https://www.youtube.com/embed/${randomKaaba}" frameborder="0"
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                    allowfullscreen
                    title="Kaaba Live Stream">
                </iframe>
                <div class="stream-label">
                    <i class="fas fa-kaaba"></i>
                    <span>Kaaba Live</span>
                </div>
            </div>
            <div class="stream-card">
                <iframe src="https://www.youtube.com/embed/${randomMadinah}" frameborder="0"
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                    allowfullscreen
                    title="Madinah Live Stream">
                </iframe>
                <div class="stream-label">
                    <i class="fas fa-mosque"></i>
                    <span>Madinah Live</span>
                </div>
            </div>
        `;
    }
  
    // AI Chat Functionality with Enhanced Free APIs
    const aiInput = document.getElementById('aiInput');
    const aiSendBtn = document.getElementById('aiSendBtn');
    const aiConversation = document.getElementById('aiConversation');
    
    // Enhanced API endpoints with fallbacks
    const APIs = {
        WIKIPEDIA: {
            url: 'https://en.wikipedia.org/w/api.php',
            params: {
                action: 'query',
                format: 'json',
                origin: '*',
                prop: 'extracts|pageimages',
                exintro: true,
                explaintext: true,
                redirects: 1,
                pithumbsize: 300,
                titles: ''
            },
            fallback: null
        },
        DICTIONARY: {
            url: 'https://api.dictionaryapi.dev/api/v2/entries/en/',
            fallback: 'https://wordsapiv1.p.rapidapi.com/words/'
        },
        WEATHER: {
            url: 'https://goweather.herokuapp.com/weather/',
            fallback: 'https://api.open-meteo.com/v1/forecast?current_weather=true&'
        },
        QURAN: {
            url: 'https://api.alquran.cloud/v1/search/',
            fallback: 'https://quran-api-id.vercel.app/surah/'
        },
        HADITH: {
            url: 'https://api.sunnah.com/v1/hadith/',
            fallback: 'https://hadith-api.vercel.app/api/hadiths/'
        }
    };
    
    // Islamic knowledge base for fallback responses
    const islamicKnowledgeBase = {
        "salah": {
            answer: "Salah is the Islamic prayer and is one of the Five Pillars of Islam. Muslims perform five daily prayers facing the Kaaba in Mecca.",
            references: ["Quran 2:43", "Sahih Bukhari Book 8"]
        },
        "ramadan": {
            answer: "Ramadan is the ninth month of the Islamic calendar, observed by Muslims worldwide as a month of fasting, prayer, reflection and community.",
            references: ["Quran 2:183-185"]
        },
        "zakat": {
            answer: "Zakat is a form of almsgiving treated in Islam as a religious obligation or tax, which by Quranic ranking is next after prayer in importance.",
            references: ["Quran 9:60"]
        },
        "hajj": {
            answer: "Hajj is an annual Islamic pilgrimage to Mecca, the holiest city for Muslims, and a mandatory religious duty for Muslims that must be carried out at least once in their lifetime.",
            references: ["Quran 22:27-28"]
        },
        "quran": {
            answer: "The Quran is the central religious text of Islam, believed by Muslims to be a revelation from God. It is organized in 114 chapters called surahs.",
            references: ["Quran 2:2"]
        }
    };
    
    function addAIMessage(content, isUser = false, data = null) {
        const messageDiv = document.createElement('div');
        messageDiv.className = `ai-message ${isUser ? 'user' : 'assistant'}`;
        
        const now = new Date();
        const timeString = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
        
        let messageContent = `<div class="message-content">${content}</div>`;
        
        if (data) {
            if (data.image) {
                messageContent += `<img src="${data.image}" class="ai-message-image" alt="API response image">`;
            }
            
            if (data.references && data.references.length > 0) {
                messageContent += `<div class="references"><strong>References:</strong><ul>`;
                data.references.forEach(ref => {
                    messageContent += `<li>${ref}</li>`;
                });
                messageContent += `</ul></div>`;
            }
        }
        
        messageContent += `<div class="ai-message-time">${timeString}</div>`;
        
        messageDiv.innerHTML = messageContent;
        aiConversation.appendChild(messageDiv);
        aiConversation.scrollTop = aiConversation.scrollHeight;
    }
    
    async function fetchWithFallback(apiConfig, query) {
        try {
            let url;
            if (apiConfig.url.includes('wikipedia')) {
                // Special handling for Wikipedia API
                const params = new URLSearchParams();
                Object.entries(apiConfig.params).forEach(([key, value]) => {
                    params.set(key, key === 'titles' ? query : value);
                });
                url = `${apiConfig.url}?${params.toString()}`;
            } else {
                url = `${apiConfig.url}${encodeURIComponent(query)}`;
            }
            
            const response = await fetch(url);
            if (!response.ok) throw new Error('Primary API failed');
            return await response.json();
        } catch (error) {
            if (apiConfig.fallback) {
                try {
                    const fallbackUrl = `${apiConfig.fallback}${encodeURIComponent(query)}`;
                    const fallbackResponse = await fetch(fallbackUrl);
                    if (!fallbackResponse.ok) throw new Error('Fallback API failed');
                    return await fallbackResponse.json();
                } catch (fallbackError) {
                    console.error('Fallback API error:', fallbackError);
                    throw fallbackError;
                }
            }
            throw error;
        }
    }
    
    async function fetchIslamicInfo(query) {
        // First check our local knowledge base
        const lowerQuery = query.toLowerCase();
        for (const [topic, info] of Object.entries(islamicKnowledgeBase)) {
            if (lowerQuery.includes(topic)) {
                return {
                    text: info.answer,
                    data: {
                        references: info.references
                    }
                };
            }
        }
        
        // If not found in local knowledge, try Quran API
        try {
            const response = await fetchWithFallback(APIs.QURAN, query);
            if (response && response.data && response.data.matches && response.data.matches.length > 0) {
                const match = response.data.matches[0];
                return {
                    text: `Quran ${match.surah.name} (${match.surah.number}):${match.number}\n${match.text}`,
                    data: {
                        references: [`Quran ${match.surah.name} ${match.number}`]
                    }
                };
            }
        } catch (error) {
            console.error('Error fetching Quran info:', error);
        }
        
        // If Quran API fails, try Hadith API
        try {
            const response = await fetchWithFallback(APIs.HADITH, query);
            if (response && response.collection && response.hadiths && response.hadiths.length > 0) {
                const hadith = response.hadiths[0];
                return {
                    text: `${hadith.collection} #${hadith.number}\n${hadith.text}`,
                    data: {
                        references: [`${hadith.collection} #${hadith.number}`]
                    }
                };
            }
        } catch (error) {
            console.error('Error fetching Hadith info:', error);
        }
        
        // If no Islamic info found, try Wikipedia
        try {
            const response = await fetchWithFallback(APIs.WIKIPEDIA, query);
            const pages = response.query.pages;
            const pageId = Object.keys(pages)[0];
            const page = pages[pageId];
            
            if (!page.missing && page.extract) {
                return {
                    text: page.extract,
                    data: {
                        image: page.thumbnail ? page.thumbnail.source : null
                    }
                };
            }
        } catch (error) {
            console.error('Error fetching Wikipedia info:', error);
        }
        
        return null;
    }
    
    function determineAPI(query) {
        // Check for Islamic questions first
        const islamicKeywords = ['islam', 'muslim', 'quran', 'sunnah', 'hadith', 'salah', 'prayer', 
                               'ramadan', 'fasting', 'hajj', 'umrah', 'zakat', 'charity'];
        
        if (islamicKeywords.some(keyword => query.toLowerCase().includes(keyword))) {
            return { type: 'ISLAMIC', query: query };
        }
        
        // Check for dictionary requests
        if (query.toLowerCase().startsWith('define ') || query.toLowerCase().startsWith('what is ') || 
            query.toLowerCase().startsWith('meaning of ')) {
            const word = query.replace(/define|what is|meaning of/gi, '').trim().split(' ')[0];
            return { type: 'DICTIONARY', query: word };
        }
        
        // Check for weather requests
        if (query.toLowerCase().startsWith('weather in ') || query.toLowerCase().startsWith('weather at ') || 
            query.toLowerCase().includes(' temperature') || query.toLowerCase().includes(' forecast')) {
            const location = query.replace(/weather in|weather at|temperature|forecast/gi, '').trim();
            return { type: 'WEATHER', query: location };
        }
        
        // Default to general knowledge
        return { type: 'WIKIPEDIA', query: query };
    }
    
    aiSendBtn.addEventListener('click', sendAIMessage);
    aiInput.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
            sendAIMessage();
        }
    });
    
    async function sendAIMessage() {
        const question = aiInput.value.trim();
        if (!question) return;
        
        addAIMessage(question, true);
        aiInput.value = '';
        
        // Show loading state
        const loadingMessage = document.createElement('div');
        loadingMessage.className = 'ai-message assistant';
        loadingMessage.innerHTML = `
            <div class="message-content">Searching for information...</div>
            <div class="ai-message-time">Just now</div>
        `;
        aiConversation.appendChild(loadingMessage);
        aiConversation.scrollTop = aiConversation.scrollHeight;
        
        try {
            // Determine which API to use
            const { type, query } = determineAPI(question);
            
            let response;
            switch (type) {
                case 'ISLAMIC':
                    response = await fetchIslamicInfo(query);
                    if (!response) {
                        throw new Error('No Islamic information found');
                    }
                    break;
                case 'DICTIONARY':
                    response = await fetchWithFallback(APIs.DICTIONARY, query);
                    if (response && response[0] && response[0].meanings) {
                        const word = response[0].word;
                        let meaningsText = `Definitions of <strong>${word}</strong>:<br><br>`;
                        
                        response[0].meanings.forEach(meaning => {
                            meaningsText += `<strong>${meaning.partOfSpeech}</strong>:<br>`;
                            meaning.definitions.slice(0, 3).forEach((def, i) => {
                                meaningsText += `${i+1}. ${def.definition}<br>`;
                            });
                            meaningsText += '<br>';
                        });
                        
                        response = { text: meaningsText };
                    } else {
                        throw new Error('Dictionary definition not found');
                    }
                    break;
                case 'WEATHER':
                    response = await fetchWithFallback(APIs.WEATHER, query);
                    if (response && response.current_weather) {
                        response = {
                            text: `Weather in ${query}:`,
                            data: {
                                weather: {
                                    temperature: `${response.current_weather.temperature}°C`,
                                    wind: `${response.current_weather.windspeed} km/h`,
                                    description: 'Current weather data'
                                }
                            }
                        };
                    } else if (response && response.temperature) {
                        response = {
                            text: `Weather in ${query}:`,
                            data: {
                                weather: {
                                    temperature: response.temperature,
                                    wind: response.wind,
                                    description: response.description
                                }
                            }
                        };
                    } else {
                        throw new Error('Weather data not found');
                    }
                    break;
                case 'WIKIPEDIA':
                default:
                    response = await fetchIslamicInfo(query);
                    if (!response) {
                        throw new Error('Information not found');
                    }
                    break;
            }
            
            // Remove loading message
            aiConversation.removeChild(loadingMessage);
            
            // Add actual response
            addAIMessage(response.text, false, response.data);
        } catch (error) {
            console.error('Error in AI response:', error);
            // Remove loading message
            aiConversation.removeChild(loadingMessage);
            
            // Fallback responses
            const responses = [
                "I'm sorry, I couldn't find information about that. Could you try asking in a different way?",
                "That's an interesting question. I specialize in Islamic knowledge - try asking about salah, fasting, or other Islamic practices.",
                "I don't have that information right now. Please ask me about basic Islamic practices and beliefs.",
                "I'm still learning! Could you ask me something more specific about Islam?"
            ];
            const randomResponse = responses[Math.floor(Math.random() * responses.length)];
            addAIMessage(randomResponse);
        }
    }
    
    // Add welcome message when the page loads
    window.addEventListener('load', function() {
        setTimeout(() => {
            addAIMessage("As-salamu alaykum! I'm your AI Islamic assistant. You can ask me about prayer times, Quran, Hadith, or any Islamic topic.", false);
        }, 1000);
    });
    // Prayer Times Functions
    async function getPrayerTimes(latitude, longitude) {
        try {
            const date = new Date();
            const today = `${date.getDate()}-${date.getMonth()+1}-${date.getFullYear()}`;
            
            const response = await fetch(
                `https://api.aladhan.com/v1/timings/${today}?latitude=${latitude}&longitude=${longitude}&method=2`
            );
            
            const data = await response.json();
            
            if (data.code === 200) {
                return {
                    fajr: convertTo12Hour(data.data.timings.Fajr),
                    sunrise: convertTo12Hour(data.data.timings.Sunrise),
                    dhuhr: convertTo12Hour(data.data.timings.Dhuhr),
                    asr: convertTo12Hour(data.data.timings.Asr),
                    maghrib: convertTo12Hour(data.data.timings.Maghrib),
                    isha: convertTo12Hour(data.data.timings.Isha),
                    location: data.data.meta.timezone
                };
            } else {
                throw new Error('Failed to fetch prayer times');
            }
        } catch (error) {
            console.error('Error fetching prayer times:', error);
            return {
                fajr: "05:15 AM",
                sunrise: "06:30 AM",
                dhuhr: "12:30 PM",
                asr: "03:45 PM",
                maghrib: "06:30 PM",
                isha: "08:00 PM",
                location: "Makkah, Saudi Arabia"
            };
        }
    }

    function convertTo12Hour(time24) {
        const [hours, minutes] = time24.split(':').map(Number);
        const period = hours >= 12 ? 'PM' : 'AM';
        const hours12 = hours % 12 || 12;
        return `${hours12}:${minutes.toString().padStart(2, '0')} ${period}`;
    }

    // Get User Location via IP API
    async function getUserLocation() {
        try {
            // First get approximate coordinates from IP
            const ipResponse = await fetch('https://ipapi.co/json/');
            const ipData = await ipResponse.json();
            
            return {
                latitude: ipData.latitude || DEFAULT_COORDS.latitude,
                longitude: ipData.longitude || DEFAULT_COORDS.longitude,
                city: ipData.city || 'Makkah',
                country: ipData.country_name || 'Saudi Arabia'
            };
        } catch (error) {
            console.error('Error getting location from IP:', error);
            return DEFAULT_COORDS;
        }
    }

    // Update Prayer Times Display
    function updatePrayerTimesDisplay(timings) {
        currentPrayerTimes = timings;
        
        document.querySelector('[data-prayer="fajr"] .prayer-time').textContent = timings.fajr;
        document.querySelector('[data-prayer="dhuhr"] .prayer-time').textContent = timings.dhuhr;
        document.querySelector('[data-prayer="asr"] .prayer-time').textContent = timings.asr;
        document.querySelector('[data-prayer="maghrib"] .prayer-time').textContent = timings.maghrib;
        document.querySelector('[data-prayer="isha"] .prayer-time').textContent = timings.isha;
        
        // Update location text
        const locationText = timings.location.split('/').pop().replace(/_/g, ' ') || 'Current Location';
        document.getElementById('locationText').textContent = locationText;
        
        // Update countdown immediately
        updateCountdown();
        
        // Update Ramadan times (Sehri and Iftar)
        updateRamadanTimes(timings);
    }

    // Update Ramadan Times
    function updateRamadanTimes(timings) {
        // For Ramadan, Sehri ends at Fajr time, Iftar is at Maghrib time
        document.getElementById('sehriTime').textContent = timings.fajr;
        document.getElementById('iftarTime').textContent = timings.maghrib;
        
        // Calculate current Ramadan day (example implementation)
        const today = new Date();
        const ramadanStart = new Date(today.getFullYear(), 2, 22); // Example start date
        const diffTime = Math.abs(today - ramadanStart);
        const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
        
        document.getElementById('ramadanDay').textContent = `Day ${diffDays} of Ramadan`;
    }

    // Update Countdown Timer
    function updateCountdown() {
        if (!currentPrayerTimes) return;
        
        const now = new Date();
        const currentHours = now.getHours();
        const currentMinutes = now.getMinutes();
        const currentSeconds = now.getSeconds();
        const currentTime = currentHours * 3600 + currentMinutes * 60 + currentSeconds;
        
        const prayerElements = document.querySelectorAll('.prayer-time-card');
        const prayerTimes = [];
        
        prayerElements.forEach(card => {
            const prayer = card.getAttribute('data-prayer');
            const timeStr = card.querySelector('.prayer-time').textContent;
            const [timePart, period] = timeStr.split(' ');
            let [hours, minutes] = timePart.split(':').map(Number);
            
            // Convert to 24-hour format
            if (period === 'PM' && hours !== 12) hours += 12;
            if (period === 'AM' && hours === 12) hours = 0;
            
            const totalSeconds = hours * 3600 + minutes * 60;
            
            prayerTimes.push({
                prayer,
                time: totalSeconds,
                element: card
            });
        });

        // Sort prayer times
        prayerTimes.sort((a, b) => a.time - b.time);
        
        // Find current and next prayer
        let currentPrayer = null;
        let nextPrayer = null;
        
        for (let i = 0; i < prayerTimes.length; i++) {
            if (currentTime < prayerTimes[i].time) {
                nextPrayer = prayerTimes[i];
                if (i > 0) {
                    currentPrayer = prayerTimes[i-1];
                } else {
                    // If next is first prayer of day, current is last prayer from previous day
                    currentPrayer = prayerTimes[prayerTimes.length - 1];
                }
                break;
            }
        }
        
        // If no next prayer found (after Isha), next is Fajr tomorrow
        if (!nextPrayer) {
            nextPrayer = prayerTimes[0];
            currentPrayer = prayerTimes[prayerTimes.length - 1];
        }
        
        // Calculate time remaining to next prayer
        let timeRemaining;
        if (nextPrayer.time > currentTime) {
            timeRemaining = nextPrayer.time - currentTime;
        } else {
            // Next prayer is tomorrow (Fajr)
            timeRemaining = (24 * 3600 - currentTime) + nextPrayer.time;
        }
        
        // Update all prayer cards
        prayerTimes.forEach(prayer => {
            // Reset all cards
            prayer.element.classList.remove('current', 'next');
            
            if (prayer === currentPrayer) {
                prayer.element.classList.add('current');
                prayer.element.querySelector('.time-remaining').textContent = 'Current prayer';
            } else if (prayer === nextPrayer) {
                prayer.element.classList.add('next');
                
                // Format time remaining
                let displayTime;
                if (timeRemaining < 3600) { // Less than 1 hour
                    const minutes = Math.floor(timeRemaining / 60);
                    const seconds = timeRemaining % 60;
                    displayTime = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                } else {
                    const hours = Math.floor(timeRemaining / 3600);
                    const minutes = Math.floor((timeRemaining % 3600) / 60);
                    displayTime = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}`;
                }
                
                prayer.element.querySelector('.time-remaining').textContent = `Next in ${displayTime}`;
                updateCountdownCircle(prayer.prayer, timeRemaining);
                
                // Show notification if prayer time is within 5 minutes
                if (timeRemaining <= 300) { // 5 minutes in seconds
                    showNotification(`${prayer.prayer} prayer time is starting soon`, 'Prayer Time Reminder');
                }
            } else {
                prayer.element.querySelector('.time-remaining').textContent = '';
            }
        });
        
        // Store current prayer state
        currentPrayerState = {
            current: currentPrayer,
            next: nextPrayer
        };
    }

    // Update Countdown Circle
    function updateCountdownCircle(prayerName, timeRemainingSeconds) {
        const circle = document.querySelector('.circle-progress');
        const circleLabel = document.getElementById('circleLabel');
        const circleSubtext = document.getElementById('circleSubtext');
        const circleTime = document.getElementById('circleTime');
        
        if (!circle || !circleLabel) return;
        
        // Format time display
        let displayTime;
        if (timeRemainingSeconds < 3600) { // Less than 1 hour
            const minutes = Math.floor(timeRemainingSeconds / 60);
            const seconds = timeRemainingSeconds % 60;
            displayTime = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        } else {
            const hours = Math.floor(timeRemainingSeconds / 3600);
            const minutes = Math.floor((timeRemainingSeconds % 3600) / 60);
            displayTime = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}`;
        }
        
        circleTime.textContent = displayTime;
        
        // Calculate percentage for circle
        const percentage = (timeRemainingSeconds / (24 * 3600)) * 100;
        const dashoffset = 628 - (628 * percentage / 100);
        
        circle.style.strokeDashoffset = dashoffset;
        
        // Map prayer names to display names
        const prayerNames = {
            fajr: 'Fajr',
            dhuhr: 'Dhuhr',
            asr: 'Asr',
            maghrib: 'Maghrib',
            isha: 'Isha'
        };
        
        circleLabel.textContent = prayerNames[prayerName] || prayerName;
        
        // Set appropriate subtext based on next prayer
        if (prayerName === 'fajr') {
            circleSubtext.textContent = 'until sunrise';
        } else if (prayerName === 'dhuhr') {
            circleSubtext.textContent = 'until Asr';
        } else if (prayerName === 'asr') {
            circleSubtext.textContent = 'until Maghrib';
        } else if (prayerName === 'maghrib') {
            circleSubtext.textContent = 'until Isha';
        } else if (prayerName === 'isha') {
            circleSubtext.textContent = 'until Fajr';
        }
    }

    // Show Notification
    function showNotification(message, title = 'Notification') {
        const notification = document.getElementById('notification');
        const notificationTitle = document.getElementById('notificationTitle');
        const notificationMessage = document.getElementById('notificationMessage');
        const notificationClose = document.getElementById('notificationClose');
        
        notificationTitle.textContent = title;
        notificationMessage.textContent = message;
        notification.classList.add('show');
        
        // Auto-hide after 5 seconds
        const timeout = setTimeout(() => {
            notification.classList.remove('show');
        }, 5000);
        
        // Close button functionality
        notificationClose.onclick = function() {
            clearTimeout(timeout);
            notification.classList.remove('show');
        };
    }

    // Update Current Date
    function updateCurrentDate() {
        const now = new Date();
        const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
        document.getElementById('currentDate').textContent = now.toLocaleDateString(undefined, options);
    }

    // Update Hijri Date
    async function updateHijriDate() {
        try {
            const date = new Date();
            const response = await fetch(`https://api.aladhan.com/v1/gToH?date=${date.getDate()}-${date.getMonth()+1}-${date.getFullYear()}`);
            const data = await response.json();
            
            if (data.code === 200) {
                const hijri = data.data.hijri;
                document.getElementById('hijriDate').textContent = 
                    `${hijri.day} ${hijri.month.en} ${hijri.year} AH`;
            }
        } catch (error) {
            console.error('Error fetching Hijri date:', error);
            document.getElementById('hijriDate').textContent = 
                "Islamic date unavailable - check back later";
        }
    }

    // Initialize Calendar
    function initializeCalendar() {
        const calendar = document.getElementById('calendar');
        const prevMonthBtn = document.getElementById('prevMonthBtn');
        const nextMonthBtn = document.getElementById('nextMonthBtn');
        
        // Generate calendar days
        function generateCalendarDays(year, month) {
            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            const daysInMonth = lastDay.getDate();
            const startingDay = firstDay.getDay();
            
            // Clear existing days (except headers)
            while (calendar.children.length > 7) {
                calendar.removeChild(calendar.lastChild);
            }
            
            // Add empty cells for days before the first day
            for (let i = 0; i < startingDay; i++) {
                const emptyDay = document.createElement('div');
                emptyDay.className = 'calendar-day';
                calendar.appendChild(emptyDay);
            }
            
            // Add days of the month
            for (let i = 1; i <= daysInMonth; i++) {
                const day = document.createElement('div');
                day.className = 'calendar-day';
                
                const dayNumber = document.createElement('div');
                dayNumber.className = 'calendar-day-number';
                dayNumber.textContent = i;
                
                day.appendChild(dayNumber);
                
                // Highlight today
                const today = new Date();
                if (year === today.getFullYear() && month === today.getMonth() && i === today.getDate()) {
                    day.classList.add('today');
                }
                
                // Add to calendar
                calendar.appendChild(day);
            }
        }
        
        // Set initial calendar to current month
        const today = new Date();
        let currentMonth = today.getMonth();
        let currentYear = today.getFullYear();
        
        generateCalendarDays(currentYear, currentMonth);
        
        // Previous month button
        prevMonthBtn.addEventListener('click', function() {
            currentMonth--;
            if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
            }
            generateCalendarDays(currentYear, currentMonth);
        });
        
        // Next month button
        nextMonthBtn.addEventListener('click', function() {
            currentMonth++;
            if (currentMonth > 11) {
                currentMonth = 0;
                currentYear++;
            }
            generateCalendarDays(currentYear, currentMonth);
        });
    }

    // Initialize the App
    async function initializeApp() {
        // Show loading state
        document.getElementById('locationText').textContent = 'Detecting location...';
        updateCurrentDate();
        updateHijriDate();
        
        // Initialize calendar
        initializeCalendar();
        
        // Get user location and prayer times
        try {
            const location = await getUserLocation();
            currentLocation = location;
            const prayerTimes = await getPrayerTimes(location.latitude, location.longitude);
            updatePrayerTimesDisplay(prayerTimes);
            
            // Update location text with city/country if available
            if (location.city && location.country) {
                document.getElementById('locationText').textContent = `${location.city}, ${location.country}`;
            }
        } catch (error) {
            console.error('Error initializing app:', error);
            // Use default times if location fails
            const defaultTimes = {
                fajr: "05:15 AM",
                sunrise: "06:30 AM",
                dhuhr: "12:30 PM",
                asr: "03:45 PM",
                maghrib: "06:30 PM",
                isha: "08:00 PM",
                location: "Makkah, Saudi Arabia"
            };
            updatePrayerTimesDisplay(defaultTimes);
        }
        
        // Fetch live streams
        fetchLiveStreams();
        
        // Update countdown every second for accurate countdown when < 1 hour
        updateCountdown();
        setInterval(updateCountdown, 1000);
        
        // Show welcome notification
        setTimeout(() => {
            showNotification('Welcome to Ishahi', 'Assalamu Alaikum');
        }, 2000);
    }

    // Refresh streams button
    document.getElementById('refreshStreams').addEventListener('click', fetchLiveStreams);

    // Close notification when clicked outside
    document.addEventListener('click', function(event) {
        const notification = document.getElementById('notification');
        if (notification.classList.contains('show') && !notification.contains(event.target)) {
            notification.classList.remove('show');
        }
    });
});
</script>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-QCJKG8NXX0"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-QCJKG8NXX0');
</script>
<script src="https://nepsen.github.io/ishahi/auto-offline.js"></script>
</body>
</html>
